# {{ ansible_managed }}
# https://wiki.mozilla.org/Security/Guidelines/OpenSSH
# CCE-80222-3
# CCE-27471-2
# CCE-27082-7
# CCE-27314-4
# CCE-80221-5
# CCE-27433-2
# CCE-27363-1
# CCE-27413-4
# CCE-80223-1
# CCE-80223-1
# CCE-80225-6
# CCE-80220-7
# CCE-80224-9
# CCE-27445-6
# CCE-82177-7

AcceptEnv LANG LC_*
AllowGroups {{ sshd_allow_groups }}
AllowAgentForwarding {{ sshd_allow_agent_forwarding }}
AllowTcpForwarding {{ sshd_allow_tcp_forwarding }}
AuthenticationMethods {{ sshd_authentication_methods }}
Banner /etc/issue.net
ChallengeResponseAuthentication no
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes256-ctr
ClientAliveCountMax 0
ClientAliveInterval 300
Compression no
GSSAPIAuthentication no
HostbasedAuthentication no
IgnoreUserKnownHosts yes
KerberosAuthentication no
KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256
LogLevel {{ sshd_log_level }}
LoginGraceTime 20
Macs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256
MaxAuthTries {{ sshd_max_auth_tries }}
MaxSessions {{ sshd_max_sessions }}
MaxStartups 10:30:60
PasswordAuthentication {{ sshd_password_authentication }}
PermitEmptyPasswords no
PermitRootLogin no
PermitUserEnvironment no
Port {{ sshd_port|int }}
PrintLastLog yes
PrintMotd no
RekeyLimit 512M 1h
StrictModes yes
Subsystem sftp internal-sftp
TCPKeepAlive no
UseDNS no
UsePAM yes
X11Forwarding no
